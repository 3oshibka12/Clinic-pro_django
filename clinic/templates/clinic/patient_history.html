{% extends 'clinic/base.html' %}

{% block content %}
<div style="max-width: 900px; margin: 40px auto; padding: 20px;">
    
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
        <h2>üìÇ –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∏—Å—Ç–æ—Ä–∏—è</h2>
        <a href="{% url 'profile' %}" class="btn btn-outline">‚Üê –ù–∞–∑–∞–¥ –≤ –ø—Ä–æ—Ñ–∏–ª—å</a>
    </div>

    {% if history %}
        <div style="display: flex; flex-direction: column; gap: 20px;">
            {% for appt in history %}
            <div style="background: white; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); overflow: hidden; border-left: 5px solid #6c757d;">
                
                <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ä—Ç–æ—á–∫–∏ (–î–∞—Ç–∞ –∏ –í—Ä–∞—á) -->
                <div style="padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                    <div>
                        <div style="font-size: 1.2rem; font-weight: bold; color: #333;">
                            {{ appt.visit_time|date:"d E Y" }} <span style="color: gray; font-size: 0.9em;">–≤ {{ appt.visit_time|date:"H:i" }}</span>
                        </div>
                        <div style="color: #007bff; margin-top: 5px;">
                            üë®‚Äç‚öïÔ∏è {{ appt.doctor_info }}
                        </div>
                    </div>
                    <div style="background: #f8f9fa; padding: 5px 10px; border-radius: 15px; font-size: 0.9rem; color: gray;">
                        –ê—Ä—Ö–∏–≤
                    </div>
                </div>

                <!-- –¢–µ–ª–æ –∫–∞—Ä—Ç–æ—á–∫–∏ (–†–µ—Ü–µ–ø—Ç) -->
                <div style="padding: 20px;">
                    {% if appt.diagnosis %}
                        <h4 style="margin: 0 0 10px 0; color: #28a745;">üíä –ù–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–µ –ª–µ—á–µ–Ω–∏–µ:</h4>
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr>
                                <td style="width: 150px; color: gray;">–î–∏–∞–≥–Ω–æ–∑:</td>
                                <td><strong>{{ appt.diagnosis }}</strong></td>
                            </tr>
                            <tr>
                                <td style="color: gray;">–ü—Ä–µ–ø–∞—Ä–∞—Ç:</td>
                                <td>{{ appt.drug_name }}</td>
                            </tr>
                            <tr>
                                <td style="color: gray;">–°—Ö–µ–º–∞:</td>
                                <td>{{ appt.frequency }} —Ä–∞–∑(–∞) –≤ –¥–µ–Ω—å, {{ appt.duration }}</td>
                            </tr>
                            {% if appt.treatment %}
                            <tr>
                                <td style="color: gray;">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</td>
                                <td>{{ appt.treatment }}</td>
                            </tr>
                            {% endif %}
                        </table>
                    {% else %}
                        <p style="color: gray; margin: 0;">–í—Ä–∞—á –Ω–µ –æ—Å—Ç–∞–≤–∏–ª –∑–∞–ø–∏—Å–µ–π –æ –ª–µ—á–µ–Ω–∏–∏ –≤ —Å–∏—Å—Ç–µ–º–µ.</p>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div style="text-align: center; padding: 50px; background: white; border-radius: 10px; color: gray;">
            <i class="fa-solid fa-folder-open" style="font-size: 3rem; margin-bottom: 20px; display: block;"></i>
            <h3>–ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–µ—â–µ–Ω–∏–π –ø—É—Å—Ç–∞</h3>
            <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤–∞—à–∏ –ø—Ä–æ—à–µ–¥—à–∏–µ –≤–∏–∑–∏—Ç—ã –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–∞—á–µ–π.</p>
        </div>
    {% endif %}

</div>
{% endblock %}